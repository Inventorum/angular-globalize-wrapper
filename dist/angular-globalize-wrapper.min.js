/* angular-globalize-wrapper - v0.2.0 - 2015-07-08
   Copyright (c) 2015 Ross Basarevych; Licensed MIT */

"use strict";var glModule=angular.module("globalizeWrapper",[]);glModule.provider("globalizeWrapper",function(){var a="bower_components/cldr-data",b="l10n",c=!0,d=["/currencies.json","/ca-gregorian.json","/timeZoneNames.json","/numbers.json"],e=["/currencyData.json","/likelySubtags.json","/plurals.json","/timeData.json","/weekData.json"];this.$get=["$q","$http","$rootScope",function(f,g,h){function i(a,b,c){for(var d=[],e=0;e<b.length;e++)d.push(g.get(a+"/"+b[e]));f.all(d).then(c)["catch"](function(){h.$broadcast("GlobalizeLoadError")})}function j(){return p&&q&&r}function k(e){if(n!=e){if(o=!1,n=e,"undefined"!=typeof m[n])return void l();p=!1,i(a+"/main/"+n,d,function(a){s=[];for(var b=0;b<a.length;b++)s.push(a[b].data);p=!0,l()}),c?(r=!1,g.get(b+"/"+n+".json").then(function(a){u[n]=a.data[n],r=!0,l()})):r=!0}}function l(){if(j()&&!o){if(o=!0,"undefined"==typeof m[n]){var a=null,b=s.concat(t);if(b.length){if(Globalize.load(b),c){var d={};d[n]=u[n],Globalize.loadMessages(d)}a=Globalize(n)}m[n]=a}h.$broadcast("GlobalizeLoadSuccess")}}var m={},n=null,o=!1,p=!1,q=!1,r=!1,s=[],t=[],u={};return i(a+"/supplemental",e,function(a){for(var b=0;b<a.length;b++)t.push(a[b].data);q=!0,l()}),{isLoaded:j,setLocale:k,getLocale:function(){return n},getGlobalize:function(a){return"undefined"==typeof a&&(a=n),m[a]},hasMessage:function(a,b){return"undefined"==typeof b&&(b=n),"undefined"!=typeof u[b][a]}}}],this.setCldrBasePath=function(b){a=b},this.setL10nBasePath=function(a){b=a},this.setL10nEnabled=function(a){c=a},this.setMainResources=function(a){d=a},this.setSupplementalResources=function(a){e=a}}),glModule.filter("glDate",["globalizeWrapper",function(a){return function(b,c){if(angular.isUndefined(b)||angular.isUndefined(c))return void 0;if(0==b.length||!a.isLoaded())return"";var d=a.getGlobalize();return d?d.formatDate(b,c):b}}]),glModule.filter("glMessage",["globalizeWrapper",function(a){return function(b,c){if(angular.isUndefined(b))return void 0;if(0==b.length||!a.isLoaded())return"";if(!a.hasMessage(b))return console.log("Missing translation: "+b),b;var d=a.getGlobalize();return d?d.formatMessage(b,c):b}}]),glModule.filter("glNumber",["globalizeWrapper",function(a){return function(b,c){if(angular.isUndefined(b))return void 0;if(0==b.length||!a.isLoaded())return"";var d=a.getGlobalize();return d?d.formatNumber(b,c):b}}]),glModule.filter("glCurrency",["globalizeWrapper",function(a){return function(b,c,d){if(angular.isUndefined(b)||angular.isUndefined(c))return void 0;if(0==b.length||!a.isLoaded())return"";var e=a.getGlobalize();return e?e.formatCurrency(b,c,d):b}}]);