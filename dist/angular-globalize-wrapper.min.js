/* angular-globalize-wrapper - v0.1.0 - 2015-02-02
   Copyright (c) 2015 Ross Basarevych; Licensed MIT */

"use strict";var glModule=angular.module("globalizeWrapper",[]);glModule.provider("globalizeWrapper",function(){var a="bower_components/cldr-data",b="l10n",c=["/currencies.json","/ca-gregorian.json","/timeZoneNames.json","/numbers.json"],d=["/currencyData.json","/likelySubtags.json","/plurals.json","/timeData.json","/weekData.json"];this.$get=["$q","$http","$rootScope",function(e,f,g){function h(a,b,c){for(var d=[],h=0;h<b.length;h++)d.push(f.get(a+"/"+b[h]));e.all(d).then(c)["catch"](function(){g.$broadcast("GlobalizeLoadError")})}function i(){return n&&o&&p}function j(d){m=d,n=!1,h(a+"/main/"+d,c,function(a){q=[];for(var b=0;b<a.length;b++)q.push(a[b].data);n=!0,k()}),p=!1,f.get(b+"/"+d+".json").then(function(a){s=a.data,p=!0,k()})}function k(){if(i()){var a=q.concat(r);a.length&&(Globalize.load(a),Globalize.loadMessages(s),l=Globalize(m)),g.$broadcast("GlobalizeLoadSuccess")}}var l=null,m=null,n=!1,o=!1,p=!1,q=[],r=[],s=[];return h(a+"/supplemental",d,function(a){for(var b=0;b<a.length;b++)r.push(a[b].data);o=!0,k()}),{isLoaded:i,setLocale:j,getLocale:function(){return m},getGlobalize:function(){return l},hasMessage:function(a){return"undefined"!=typeof s[m][a]}}}],this.setCldrBasePath=function(b){a=b},this.setL10nBasePath=function(a){b=a},this.setMainResources=function(a){c=a},this.setSupplementalResources=function(a){d=a}}),glModule.filter("glDate",["globalizeWrapper",function(a){return function(b,c){if(angular.isUndefined(b)||angular.isUndefined(c))return void 0;if(0==b.length||!a.isLoaded())return"";var d=a.getGlobalize();return d?d.formatDate(b,c):b}}]),glModule.filter("glMessage",["globalizeWrapper",function(a){return function(b,c){if(angular.isUndefined(b))return void 0;if(0==b.length||!a.isLoaded())return"";if(!a.hasMessage(b))return console.log("Missing translation: "+b),b;var d=a.getGlobalize();return d?d.formatMessage(b,c):b}}]),glModule.filter("glNumber",["globalizeWrapper",function(a){return function(b,c){if(angular.isUndefined(b))return void 0;if(0==b.length||!a.isLoaded())return"";var d=a.getGlobalize();return d?d.formatNumber(b,c):b}}]),glModule.filter("glCurrency",["globalizeWrapper",function(a){return function(b,c,d){if(angular.isUndefined(b)||angular.isUndefined(c))return void 0;if(0==b.length||!a.isLoaded())return"";var e=a.getGlobalize();return e?e.formatCurrency(b,c,d):b}}]);