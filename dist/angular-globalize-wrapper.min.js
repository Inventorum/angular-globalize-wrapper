/* angular-globalize-wrapper - v0.1.0 - 2015-02-03
   Copyright (c) 2015 Ross Basarevych; Licensed MIT */

"use strict";var glModule=angular.module("globalizeWrapper",[]);glModule.provider("globalizeWrapper",function(){var a="bower_components/cldr-data",b="l10n",c=["/currencies.json","/ca-gregorian.json","/timeZoneNames.json","/numbers.json"],d=["/currencyData.json","/likelySubtags.json","/plurals.json","/timeData.json","/weekData.json"];this.$get=["$q","$http","$rootScope",function(e,f,g){function h(a,b,c){for(var d=[],h=0;h<b.length;h++)d.push(f.get(a+"/"+b[h]));e.all(d).then(c)["catch"](function(){g.$broadcast("GlobalizeLoadError")})}function i(){return o&&p&&q}function j(d){if(m!=d){if(n=!1,m=d,"undefined"!=typeof l[m])return void k();o=!1,h(a+"/main/"+m,c,function(a){r=[];for(var b=0;b<a.length;b++)r.push(a[b].data);o=!0,k()}),q=!1,f.get(b+"/"+m+".json").then(function(a){t[m]=a.data[m],q=!0,k()})}}function k(){if(i()&&!n){if(n=!0,"undefined"==typeof l[m]){var a=null,b=r.concat(s);if(b.length){Globalize.load(b);var c={};c[m]=t[m],Globalize.loadMessages(c),a=Globalize(m)}l[m]=a}g.$broadcast("GlobalizeLoadSuccess")}}var l={},m=null,n=!1,o=!1,p=!1,q=!1,r=[],s=[],t={};return h(a+"/supplemental",d,function(a){for(var b=0;b<a.length;b++)s.push(a[b].data);p=!0,k()}),{isLoaded:i,setLocale:j,getLocale:function(){return m},getGlobalize:function(a){return"undefined"==typeof a&&(a=m),l[a]},hasMessage:function(a,b){return"undefined"==typeof b&&(b=m),"undefined"!=typeof t[b][a]}}}],this.setCldrBasePath=function(b){a=b},this.setL10nBasePath=function(a){b=a},this.setMainResources=function(a){c=a},this.setSupplementalResources=function(a){d=a}}),glModule.filter("glDate",["globalizeWrapper",function(a){return function(b,c){if(angular.isUndefined(b)||angular.isUndefined(c))return void 0;if(0==b.length||!a.isLoaded())return"";var d=a.getGlobalize();return d?d.formatDate(b,c):b}}]),glModule.filter("glMessage",["globalizeWrapper",function(a){return function(b,c){if(angular.isUndefined(b))return void 0;if(0==b.length||!a.isLoaded())return"";if(!a.hasMessage(b))return console.log("Missing translation: "+b),b;var d=a.getGlobalize();return d?d.formatMessage(b,c):b}}]),glModule.filter("glNumber",["globalizeWrapper",function(a){return function(b,c){if(angular.isUndefined(b))return void 0;if(0==b.length||!a.isLoaded())return"";var d=a.getGlobalize();return d?d.formatNumber(b,c):b}}]),glModule.filter("glCurrency",["globalizeWrapper",function(a){return function(b,c,d){if(angular.isUndefined(b)||angular.isUndefined(c))return void 0;if(0==b.length||!a.isLoaded())return"";var e=a.getGlobalize();return e?e.formatCurrency(b,c,d):b}}]);